# find-hacks-by-logs
# Intrusion Detection System Based on Server Logs

Этот проект предназначен для анализа логов серверов и выявления подозрительной активности, такой как:
1. Многократные неудачные попытки входа.
2. Резкие скачки объема трафика.
3. Обращения с подозрительных IP-адресов.

## Особенности
- Поддержка лог-файлов формата `access.log` сервера Nginx.
- Выявление аномальной активности на основе HTTP-статусов (401, 403).
- Анализ объемов трафика по IP-адресам.
- Возможность добавлять список известных подозрительных IP-адресов.

## Требования
Для работы программы требуется Python 3.7+ и следующие библиотеки:
- `re` (регулярные выражения, встроено в Python)
- `datetime` (встроено в Python)
- `collections` (встроено в Python)

## Установка
1. Клонируйте репозиторий:
   
bash
   git clone https://github.com/sdf4h/find-hacks-by-logs.git 
   

2. Убедитесь, что установлен Python 3.7+.

3. Скопируйте лог-файл в форматах Nginx (например, access.log) в корень директории проекта.

## Использование
1. Откройте файл `log_analyzer.py`.
2. Укажите путь к лог-файлу в переменной `log_file`:
   
python
   logfile = "access.log"  # Укажите ваш путь к логам
   ```
3. По желанию добавьте известные подозрительные IP-адреса в переменную `knownsuspiciousips`:
   ```python
   knownsuspiciousips = {"192.168.1.100", "203.0.113.42"}
   ```
4. Запустите скрипт:
   ```bash
   python loganalyzer.py   

5. Скрипт проанализирует логи и выведет список выявленной подозрительной активности. Пример:
   
   Обнаружена подозрительная активность:
   - Подозрительная активность: много неудачных попыток входа с IP 192.168.1.1
   - Подозрительная активность: обращение с известного подозрительного IP 203.0.113.42
   

Если подозрительная активность не обнаружена, вы увидите сообщение:
Подозрительной активности не обнаружено.

## Формат логов
Программа поддерживает стандартный формат логов Nginx `access.log`. Пример строки:
192.168.1.1 - - 12/Oct/2023:14:34:58 +0000 "GET / HTTP/1.1" 401 0

Формат включает:
- **IP** — IP-адрес пользователя.
- **Дата/время** — время выполнения запроса.
- **Метод/ресурс** — HTTP-метод и запрашиваемый ресурс.
- **Статус** — HTTP-код ответа (например, 200, 403, 401).
- **Объем** — количество переданных данных (в байтах).

**Важно**: Если у вас нестандартный формат логов, настройте регулярное выражение в функции `parse_log_line`.

## Настройки
- **Количество неудачных входов для предупреждения**: измените значение `failed_login_attempts_threshold` в функции `analyze_logs`.
- **Порог трафика (байты)**: измените значение `traffic_threshold` в функции `analyze_logs`.

## Идеи для доработки
- Добавить поддержку других форматов логов (например, Apache).
- Реализовать соединение с базой данных для хранения истории анализов.
- Интеграция с уведомлениями (например, отправка сообщений в Telegram).
- Сделать анализатор более "умным", используя алгоритмы машинного обучения.

